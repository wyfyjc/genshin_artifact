"use strict";(self["webpackChunkgenshin_artifacts"]=self["webpackChunkgenshin_artifacts"]||[]).push([[121],{59098:function(e,t,l){l.d(t,{YK:function(){return n},$o:function(){return r},eH:function(){return u}});l(33948);var a=l(49811);l(60285),l(41637);function n(e,t){const a=new Worker(new URL(l.p+l.u(988),l.b));return new Promise(((l,n)=>{a.onmessage=function(n){const o=n.data.type;if("ready"===o)a.postMessage({input:e,artifacts:t});else if("result"===o){const e=n.data.data.result;a.terminate(),l(e)}},a.onerror=function(e){n(e)}}))}l(70084);var o=l(59e3);function r(e,t,a=12e4){const n=new Worker(new URL(l.p+l.u(165),l.b)),r=(0,o.p$)(e);return new Promise(((e,l)=>{const o=setTimeout((()=>{l("计算超时")}),a);n.onmessage=l=>{if("ready"===l.data.type)n.postMessage({potentialFunctionInterface:r,artifacts:t});else{const t=l.data.data.results;clearTimeout(o),e(t)}},n.onerror=e=>{l("计算发生错误："+e.message),clearTimeout(o)}})).finally((()=>{n.terminate()}))}async function u(e,t,l,n){const o=await(0,a.n)();return o.CommonInterface.get_artifacts_rank_by_character(e,t,l,n)}},28396:function(e,t,l){l.d(t,{Z:function(){return c}});var a=l(10311),n=l(29491),o=(l(50657),l(60096),l(33948),l(64055)),r={__name:"SelectPreset",props:{modelValue:String},setup(e){const t=(0,o.B)(),l=(0,a.computed)((()=>{let e=[];for(let l of t.allFlat.value)e.push(l.name);return e}));return(t,o)=>{const r=n.BT,u=n.km;return(0,a.openBlock)(),(0,a.createBlock)(u,{"model-value":e.modelValue,"onUpdate:modelValue":o[0]||(o[0]=e=>t.$emit("update:modelValue",e))},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(l),(e=>((0,a.openBlock)(),(0,a.createBlock)(r,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["model-value"])}}};const u=r;var c=u},32012:function(e,t,l){l.r(t),l.d(t,{default:function(){return K}});var a=l(79509),n=l(89804),o=l(10311),r=l(35267),u=(l(45177),l(19651)),c=(l(71683),l(31838)),i=(l(87228),l(7810)),s=(l(44163),l(77049)),m=(l(75915),l(21491)),d=(l(72142),l(28785)),f=(l(9638),l(33948),l(3857)),p=l(59098),v=l(65579),g=l(83549),k=l(82749),h=l(28396),y=l(69039),V=l(87749),B=l(64055),w=l(33227),_=l(49811),N=l(59e3),x=l(3205),b=l(68986),C=l(90871),E=l(87831),T=l(9012);const S=e=>((0,o.pushScopeId)("data-v-1dfa689f"),e=e(),(0,o.popScopeId)(),e),z={key:1,style:{padding:"0 20px"}},P={style:{"margin-bottom":"12px"}},U={style:{display:"flex","justify-content":"space-between","align-items":"center"},class:"member-header"},Z={class:"team-title"},D={class:"common-title2"},I={class:"common-title2"},L={class:"result-item-top"},F=S((()=>(0,o.createElementVNode)("div",{class:"result-item-buttons"},null,-1))),$={class:"result-item-content"},j={key:1,style:{display:"flex","justify-content":"center"}};var A=(0,o.defineComponent)({__name:"TeamOptimizationPage",async setup(e){let t,l;const{t:S}=(0,T.QT)(),A=(0,V.n)(),M=(0,B.B)(),R=(0,w.c7)(),K=([t,l]=(0,o.withAsyncContext)((()=>(0,_.n)())),t=await t,l(),t),O=(0,o.ref)([null]),W=(0,o.ref)([0]),Y=8;function q(){O.value.length!==Y?(O.value.push(null),W.value.push(0)):(0,a.z8)({message:"最多支持8个成员",type:"error"})}function G(e){1!==O.value.length&&(O.value.splice(e,1),W.value.splice(e,1))}const H=(0,o.computed)((()=>{let e=[];for(let t of O.value.values())if(t){const l=M.presets.value[t];l&&e.push(l)}return e})),Q=(0,o.ref)([]),J=(0,o.ref)(0),X=(0,o.computed)((()=>0===Q.value.length?null:Q.value[J.value]));function ee(e){J.value=e-1}const te=(0,o.ref)(!1),le=(0,o.ref)(null);function ae(e){let t=[];if(X.value){const l=Object.values(X.value[e]),a=[];for(let e of l){const t=A.artifacts.value.get(e);t&&a.push(t)}t=a.map((e=>(0,f.Lz)(e)))}return{character:H.value[e].item.character,weapon:H.value[e].item.weapon,buffs:H.value[e].item.buffs,artifacts:t}}async function ne(e){const t=ae(e);le.value=await K.CommonInterface.get_attribute(t),te.value=!0}function oe(e){A.toggleArtifact(e)}const re=(0,o.computed)((()=>{let e=[];for(let t of A.artifacts.value.values())t.level>=16&&!t.omit&&e.push(t);return e})),ue=(0,o.computed)((()=>re.value.map(f.Lz))),ce=(0,o.computed)((()=>H.value.map((e=>(0,v.DR)(e.item))))),ie={mva_step:5,work_space:1e3,max_re_optimize:5,max_search:1e6,count:1e3},se=(0,o.computed)((()=>({single_interfaces:ce.value,weights:W.value,hyper_param:ie})));function me(){const e=H.value.length===O.value.length;if(!e)return void(0,a.z8)({message:"请选择计算预设",type:"error"});const t=(0,N.p$)(se.value),l=ue.value,o=n.kN.service({text:"莫娜占卜中（可能需要数分钟）",lock:!0,fullscreen:!0});(0,p.YK)(t,l).then((e=>{Q.value=e.artifacts,J.value=0})).catch((e=>{var t;(0,a.z8)({message:`计算过程发生错误：${null!==(t=e.message)&&void 0!==t?t:e}`,type:"error"}),console.error(e)})).finally((()=>{o.close()}))}return(0,o.watch)((()=>R.currentAccountId.value),(()=>{O.value=[null],W.value=[0],Q.value=[],J.value=0})),(e,t)=>{const l=d.GT,a=m.zd,n=s.mi,f=i.BM,p=c.Dv,v=u.d6,V=r.dq;return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createVNode)(a,{title:(0,o.unref)(S)("misc.panel"),modelValue:te.value,"onUpdate:modelValue":t[0]||(t[0]=e=>te.value=e),size:(0,o.unref)(g.B)?"30%":"100%"},{default:(0,o.withCtx)((()=>[le.value?((0,o.openBlock)(),(0,o.createElementBlock)("div",z,[(0,o.createVNode)((0,o.unref)(y.Z),{attribute:le.value},null,8,["attribute"])])):((0,o.openBlock)(),(0,o.createBlock)(l,{key:0},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("In theory, you should not see this")])),_:1}))])),_:1},8,["title","modelValue","size"]),(0,o.createVNode)(V,{gutter:16},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,{md:6,sm:24,class:"mona-scroll-hidden left"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",P,[(0,o.createVNode)(n,{type:"primary",icon:(0,o.unref)(x.Z),onClick:me},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)((0,o.unref)(S)("teamPage.start")),1)])),_:1},8,["icon"]),(0,o.createVNode)(n,{icon:(0,o.unref)(b.Z),onClick:q},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)((0,o.unref)(S)("teamPage.add")),1)])),_:1},8,["icon"])]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(O.value,((e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:t,class:"member-item"},[(0,o.createElementVNode)("div",U,[(0,o.createElementVNode)("p",Z,(0,o.toDisplayString)((0,o.unref)(S)("teamPage.member"))+(0,o.toDisplayString)(t+1),1),(0,o.createElementVNode)("div",null,[(0,o.createVNode)(n,{circle:"",text:"",icon:(0,o.unref)(C.Z),onClick:e=>G(t),style:{color:"white"}},null,8,["icon","onClick"])])]),(0,o.createElementVNode)("p",D,(0,o.toDisplayString)((0,o.unref)(S)("misc.preset")),1),(0,o.createVNode)(h.Z,{modelValue:O.value[t],"onUpdate:modelValue":e=>O.value[t]=e},null,8,["modelValue","onUpdate:modelValue"]),(0,o.createElementVNode)("p",I,(0,o.toDisplayString)((0,o.unref)(S)("teamPage.weight")),1),(0,o.createVNode)(f,{modelValue:W.value[t],"onUpdate:modelValue":e=>W.value[t]=e,min:0,max:1,step:.01,"show-input":!0,style:{"padding-left":"8px"}},null,8,["modelValue","onUpdate:modelValue","step"])])))),128))])),_:1}),(0,o.createVNode)(p,{md:18,sm:24,class:"mona-scroll-hidden right"},{default:(0,o.withCtx)((()=>[(0,o.unref)(X)?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createVNode)(v,{"model-value":J.value+1,"onUpdate:modelValue":ee,min:1,max:Q.value.length,style:{"margin-bottom":"12px"}},null,8,["model-value","max"]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(X),((e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:t,class:"result-item"},[(0,o.createElementVNode)("div",L,[(0,o.createElementVNode)("div",null,[(0,o.createVNode)(n,{icon:(0,o.unref)(E.Z),circle:"",text:"",title:(0,o.unref)(S)("teamPage.showStat"),onClick:e=>ne(t)},null,8,["icon","title","onClick"])]),F]),(0,o.createElementVNode)("div",$,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(X)[t],(e=>((0,o.openBlock)(),(0,o.createBlock)(k.Z,{key:e,item:(0,o.unref)(A).artifacts.value.get(e),buttons:!0,"lock-button":!0,"delete-button":!1,"edit-button":!1,onToggle:t=>oe(e)},null,8,["item","onToggle"])))),128))])])))),128))],64)):((0,o.openBlock)(),(0,o.createElementBlock)("div",j,[(0,o.createVNode)(l)]))])),_:1})])),_:1})])}}}),M=l(83744);const R=(0,M.Z)(A,[["__scopeId","data-v-1dfa689f"]]);var K=R}}]);